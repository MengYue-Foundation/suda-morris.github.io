
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>WenRis Blog</title>
	<meta name="author" content="suda-morris">

	
	<meta name="description" content="WenRis Blog">
	<meta name="keywords" content="C/C++,Python,Lua">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="WenRis Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">WenRis Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/blog/categories">Categories</a></li>
	<li><a href="/aboutme">About</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
	<li><a href="/blog/categories">Categories</a></li>
	<li><a href="/aboutme">About</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.baidu.com" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:suda-morris.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/Morris1106com" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/suda-morris" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.baidu.com" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:suda-morris.github.io">
	</form>
</nav>

</header>
	
		
	

	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/13/start-dot-s/">
		
			start.S</a>
	</h2>
	<div class="entry-content">
		<figure class='code'><figcaption><span>start.S</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
<span class='line-number'>429</span>
<span class='line-number'>430</span>
<span class='line-number'>431</span>
<span class='line-number'>432</span>
<span class='line-number'>433</span>
<span class='line-number'>434</span>
<span class='line-number'>435</span>
<span class='line-number'>436</span>
<span class='line-number'>437</span>
<span class='line-number'>438</span>
<span class='line-number'>439</span>
<span class='line-number'>440</span>
<span class='line-number'>441</span>
<span class='line-number'>442</span>
<span class='line-number'>443</span>
<span class='line-number'>444</span>
<span class='line-number'>445</span>
<span class='line-number'>446</span>
<span class='line-number'>447</span>
<span class='line-number'>448</span>
<span class='line-number'>449</span>
<span class='line-number'>450</span>
<span class='line-number'>451</span>
<span class='line-number'>452</span>
<span class='line-number'>453</span>
<span class='line-number'>454</span>
<span class='line-number'>455</span>
<span class='line-number'>456</span>
<span class='line-number'>457</span>
<span class='line-number'>458</span>
<span class='line-number'>459</span>
<span class='line-number'>460</span>
<span class='line-number'>461</span>
<span class='line-number'>462</span>
<span class='line-number'>463</span>
<span class='line-number'>464</span>
<span class='line-number'>465</span>
<span class='line-number'>466</span>
<span class='line-number'>467</span>
<span class='line-number'>468</span>
<span class='line-number'>469</span>
<span class='line-number'>470</span>
<span class='line-number'>471</span>
<span class='line-number'>472</span>
<span class='line-number'>473</span>
<span class='line-number'>474</span>
<span class='line-number'>475</span>
<span class='line-number'>476</span>
<span class='line-number'>477</span>
<span class='line-number'>478</span>
<span class='line-number'>479</span>
<span class='line-number'>480</span>
<span class='line-number'>481</span>
<span class='line-number'>482</span>
<span class='line-number'>483</span>
<span class='line-number'>484</span>
<span class='line-number'>485</span>
<span class='line-number'>486</span>
<span class='line-number'>487</span>
<span class='line-number'>488</span>
<span class='line-number'>489</span>
<span class='line-number'>490</span>
<span class='line-number'>491</span>
<span class='line-number'>492</span>
<span class='line-number'>493</span>
<span class='line-number'>494</span>
<span class='line-number'>495</span>
<span class='line-number'>496</span>
<span class='line-number'>497</span>
<span class='line-number'>498</span>
<span class='line-number'>499</span>
<span class='line-number'>500</span>
<span class='line-number'>501</span>
<span class='line-number'>502</span>
<span class='line-number'>503</span>
<span class='line-number'>504</span>
<span class='line-number'>505</span>
<span class='line-number'>506</span>
<span class='line-number'>507</span>
<span class='line-number'>508</span>
<span class='line-number'>509</span>
<span class='line-number'>510</span>
<span class='line-number'>511</span>
<span class='line-number'>512</span>
<span class='line-number'>513</span>
<span class='line-number'>514</span>
<span class='line-number'>515</span>
<span class='line-number'>516</span>
<span class='line-number'>517</span>
<span class='line-number'>518</span>
<span class='line-number'>519</span>
<span class='line-number'>520</span>
<span class='line-number'>521</span>
<span class='line-number'>522</span>
<span class='line-number'>523</span>
<span class='line-number'>524</span>
<span class='line-number'>525</span>
<span class='line-number'>526</span>
<span class='line-number'>527</span>
<span class='line-number'>528</span>
<span class='line-number'>529</span>
<span class='line-number'>530</span>
<span class='line-number'>531</span>
<span class='line-number'>532</span>
<span class='line-number'>533</span>
<span class='line-number'>534</span>
<span class='line-number'>535</span>
<span class='line-number'>536</span>
<span class='line-number'>537</span>
<span class='line-number'>538</span>
<span class='line-number'>539</span>
<span class='line-number'>540</span>
<span class='line-number'>541</span>
<span class='line-number'>542</span>
<span class='line-number'>543</span>
<span class='line-number'>544</span>
<span class='line-number'>545</span>
<span class='line-number'>546</span>
<span class='line-number'>547</span>
<span class='line-number'>548</span>
<span class='line-number'>549</span>
<span class='line-number'>550</span>
<span class='line-number'>551</span>
<span class='line-number'>552</span>
<span class='line-number'>553</span>
<span class='line-number'>554</span>
<span class='line-number'>555</span>
<span class='line-number'>556</span>
<span class='line-number'>557</span>
<span class='line-number'>558</span>
<span class='line-number'>559</span>
<span class='line-number'>560</span>
<span class='line-number'>561</span>
<span class='line-number'>562</span>
<span class='line-number'>563</span>
<span class='line-number'>564</span>
<span class='line-number'>565</span>
<span class='line-number'>566</span>
<span class='line-number'>567</span>
<span class='line-number'>568</span>
<span class='line-number'>569</span>
<span class='line-number'>570</span>
<span class='line-number'>571</span>
<span class='line-number'>572</span>
<span class='line-number'>573</span>
<span class='line-number'>574</span>
<span class='line-number'>575</span>
<span class='line-number'>576</span>
<span class='line-number'>577</span>
<span class='line-number'>578</span>
<span class='line-number'>579</span>
<span class='line-number'>580</span>
<span class='line-number'>581</span>
<span class='line-number'>582</span>
<span class='line-number'>583</span>
<span class='line-number'>584</span>
<span class='line-number'>585</span>
<span class='line-number'>586</span>
<span class='line-number'>587</span>
<span class='line-number'>588</span>
<span class='line-number'>589</span>
<span class='line-number'>590</span>
<span class='line-number'>591</span>
<span class='line-number'>592</span>
<span class='line-number'>593</span>
<span class='line-number'>594</span>
<span class='line-number'>595</span>
<span class='line-number'>596</span>
<span class='line-number'>597</span>
<span class='line-number'>598</span>
<span class='line-number'>599</span>
<span class='line-number'>600</span>
<span class='line-number'>601</span>
<span class='line-number'>602</span>
<span class='line-number'>603</span>
<span class='line-number'>604</span>
<span class='line-number'>605</span>
<span class='line-number'>606</span>
<span class='line-number'>607</span>
<span class='line-number'>608</span>
<span class='line-number'>609</span>
<span class='line-number'>610</span>
<span class='line-number'>611</span>
<span class='line-number'>612</span>
<span class='line-number'>613</span>
<span class='line-number'>614</span>
<span class='line-number'>615</span>
<span class='line-number'>616</span>
<span class='line-number'>617</span>
<span class='line-number'>618</span>
<span class='line-number'>619</span>
<span class='line-number'>620</span>
<span class='line-number'>621</span>
<span class='line-number'>622</span>
<span class='line-number'>623</span>
<span class='line-number'>624</span>
<span class='line-number'>625</span>
<span class='line-number'>626</span>
<span class='line-number'>627</span>
<span class='line-number'>628</span>
<span class='line-number'>629</span>
<span class='line-number'>630</span>
<span class='line-number'>631</span>
<span class='line-number'>632</span>
<span class='line-number'>633</span>
<span class='line-number'>634</span>
<span class='line-number'>635</span>
<span class='line-number'>636</span>
<span class='line-number'>637</span>
<span class='line-number'>638</span>
<span class='line-number'>639</span>
<span class='line-number'>640</span>
<span class='line-number'>641</span>
<span class='line-number'>642</span>
<span class='line-number'>643</span>
<span class='line-number'>644</span>
<span class='line-number'>645</span>
<span class='line-number'>646</span>
<span class='line-number'>647</span>
<span class='line-number'>648</span>
<span class='line-number'>649</span>
<span class='line-number'>650</span>
<span class='line-number'>651</span>
<span class='line-number'>652</span>
<span class='line-number'>653</span>
<span class='line-number'>654</span>
<span class='line-number'>655</span>
<span class='line-number'>656</span>
<span class='line-number'>657</span>
<span class='line-number'>658</span>
<span class='line-number'>659</span>
<span class='line-number'>660</span>
<span class='line-number'>661</span>
<span class='line-number'>662</span>
<span class='line-number'>663</span>
<span class='line-number'>664</span>
<span class='line-number'>665</span>
<span class='line-number'>666</span>
<span class='line-number'>667</span>
<span class='line-number'>668</span>
<span class='line-number'>669</span>
<span class='line-number'>670</span>
<span class='line-number'>671</span>
<span class='line-number'>672</span>
<span class='line-number'>673</span>
<span class='line-number'>674</span>
<span class='line-number'>675</span>
<span class='line-number'>676</span>
<span class='line-number'>677</span>
<span class='line-number'>678</span>
<span class='line-number'>679</span>
<span class='line-number'>680</span>
<span class='line-number'>681</span>
<span class='line-number'>682</span>
<span class='line-number'>683</span>
<span class='line-number'>684</span>
<span class='line-number'>685</span>
<span class='line-number'>686</span>
<span class='line-number'>687</span>
<span class='line-number'>688</span>
<span class='line-number'>689</span>
</pre></td><td class='code'><pre><code class='C'><span class='line'><span class="cp">#include &lt;config.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;version.h&gt;</span>
</span><span class='line'><span class="cp">#ifdef CONFIG_ENABLE_MMU</span>
</span><span class='line'><span class="cp">#include &lt;asm/proc/domain.h&gt;</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'><span class="cp">#include &lt;regs.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifndef CONFIG_ENABLE_MMU</span>
</span><span class='line'><span class="cp">#ifndef CFG_PHY_UBOOT_BASE</span>
</span><span class='line'><span class="cp">#define CFG_PHY_UBOOT_BASE   CFG_UBOOT_BASE</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Jump vector table as in table 3.1 in [1]</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">_start</span>
</span><span class='line'><span class="nl">_start</span><span class="p">:</span> <span class="n">b</span>   <span class="n">reset</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_undefined_instruction</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_software_interrupt</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_prefetch_abort</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_data_abort</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_not_used</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_irq</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_fiq</span>
</span><span class='line'>
</span><span class='line'><span class="nl">_undefined_instruction</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">undefined_instruction</span>
</span><span class='line'><span class="nl">_software_interrupt</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">software_interrupt</span>
</span><span class='line'><span class="nl">_prefetch_abort</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">prefetch_abort</span>
</span><span class='line'><span class="nl">_data_abort</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">data_abort</span>
</span><span class='line'><span class="nl">_not_used</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">not_used</span>
</span><span class='line'><span class="nl">_irq</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">irq</span>
</span><span class='line'><span class="nl">_fiq</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">fiq</span>
</span><span class='line'><span class="nl">_pad</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="mh">0x12345678</span> <span class="cm">/* now 16*4=64 */</span>
</span><span class='line'><span class="p">.</span><span class="n">global</span> <span class="n">_end_vect</span>
</span><span class='line'><span class="nl">_end_vect</span><span class="p">:</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">balignl</span> <span class="mi">16</span><span class="p">,</span><span class="mh">0xdeadbeef</span>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Startup Code (reset vector)</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * do important init only if we don&#39;t start from memory!</span>
</span><span class='line'><span class="cm"> * setup Memory and board specific bits prior to relocation.</span>
</span><span class='line'><span class="cm"> * relocate armboot to ram</span>
</span><span class='line'><span class="cm"> * setup stack</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'><span class="nl">_TEXT_BASE</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">TEXT_BASE</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * Below variable is very important because we use MMU in U-Boot.</span>
</span><span class='line'><span class="cm"> * Without it, we cannot run code correctly before MMU is ON.</span>
</span><span class='line'><span class="cm"> * by scsuh.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="nl">_TEXT_PHY_BASE</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">CFG_PHY_UBOOT_BASE</span>
</span><span class='line'>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">_armboot_start</span>
</span><span class='line'><span class="nl">_armboot_start</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">_start</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * These are defined in the board-specific linker script.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">_bss_start</span>
</span><span class='line'><span class="nl">_bss_start</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">__bss_start</span>
</span><span class='line'>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">_bss_end</span>
</span><span class='line'><span class="nl">_bss_end</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">_end</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_USE_IRQ</span>
</span><span class='line'><span class="cm">/* IRQ stack memory (calculated at run-time) */</span>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">IRQ_STACK_START</span>
</span><span class='line'><span class="nl">IRQ_STACK_START</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="mh">0x0badc0de</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* IRQ stack memory (calculated at run-time) */</span>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">FIQ_STACK_START</span>
</span><span class='line'><span class="nl">FIQ_STACK_START</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="mh">0x0badc0de</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * the actual reset code</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'><span class="nl">reset</span><span class="p">:</span>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm">  * set the cpu to SVC32 mode</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">mrs</span>  <span class="n">r0</span><span class="p">,</span><span class="n">cpsr</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="err">#</span><span class="mh">0x1f</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="err">#</span><span class="mh">0xd3</span>
</span><span class='line'>  <span class="n">msr</span>  <span class="n">cpsr</span><span class="p">,</span><span class="n">r0</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * CPU_init_critical registers</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * setup important registers</span>
</span><span class='line'><span class="cm"> * setup memory timing</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>         <span class="cm">/*</span>
</span><span class='line'><span class="cm">         * we do sys-critical inits only at reboot,</span>
</span><span class='line'><span class="cm">         * not when booting from ram!</span>
</span><span class='line'><span class="cm">         */</span>
</span><span class='line'><span class="nl">cpu_init_crit</span><span class="p">:</span>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm">  * flush v4 I/D caches</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="mi">0</span>    <span class="cm">/* flush v3/v4 cache */</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c8</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="mi">0</span>    <span class="cm">/* flush v4 TLB */</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm">  * disable MMU stuff and caches</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">mrc</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00002300</span>    <span class="err">@</span> <span class="n">clear</span> <span class="n">bits</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span><span class="o">:</span><span class="mi">8</span> <span class="p">(</span><span class="o">--</span><span class="n">V</span><span class="o">-</span> <span class="o">--</span><span class="n">RS</span><span class="p">)</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00000087</span>    <span class="err">@</span> <span class="n">clear</span> <span class="n">bits</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="mi">0</span> <span class="p">(</span><span class="n">B</span><span class="o">---</span> <span class="o">-</span><span class="n">CAM</span><span class="p">)</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00000002</span>    <span class="err">@</span> <span class="n">set</span> <span class="n">bit</span> <span class="mi">2</span> <span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="n">Align</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00001000</span>    <span class="err">@</span> <span class="n">set</span> <span class="n">bit</span> <span class="mi">12</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="n">I</span><span class="o">-</span><span class="n">Cache</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Peri port setup */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x70000000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x13</span>
</span><span class='line'>      <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">r0</span><span class="p">,</span><span class="n">c15</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="mi">4</span>       <span class="err">@</span> <span class="mi">256</span><span class="n">M</span><span class="p">(</span><span class="mh">0x70000000</span><span class="o">-</span><span class="mh">0x7fffffff</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_ONENAND</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x70000000</span>        <span class="err">@</span> <span class="n">onenand</span> <span class="n">controller</span> <span class="n">setup</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x100000</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x4000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xe0</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#if defined(CONFIG_S3C6410) || defined(CONFIG_S3C6430)</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">300</span>       <span class="err">@</span> <span class="n">disable</span> <span class="n">watchdog</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x23000000</span>      <span class="err">@</span> <span class="n">start</span> <span class="n">buffer</span> <span class="k">register</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x30000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc800</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x20000000</span>        <span class="err">@</span> <span class="n">start</span> <span class="n">buffer</span> <span class="k">register</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc30000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc800</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0400</span>        <span class="err">@</span> <span class="n">start</span> <span class="n">address1</span> <span class="k">register</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x84</span><span class="p">]</span>      <span class="err">@</span> <span class="n">ecc</span> <span class="n">bypass</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x100</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x84</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r3</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>     <span class="err">@</span> <span class="n">DFS</span><span class="p">,</span> <span class="n">FBA</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00</span><span class="p">]</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x04</span><span class="p">]</span>      <span class="err">@</span> <span class="n">select</span> <span class="n">dataram</span> <span class="k">for</span> <span class="n">DDP</span> <span class="n">as</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r4</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x104</span>       <span class="err">@</span> <span class="n">interrupt</span> <span class="k">register</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0002</span>      <span class="err">@</span> <span class="n">FPA</span><span class="p">,</span> <span class="n">FSA</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r6</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0800</span>      <span class="err">@</span> <span class="n">BSA</span>
</span><span class='line'>
</span><span class='line'><span class="nl">onenand_bl1_load</span><span class="p">:</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r5</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1c</span><span class="p">]</span>      <span class="err">@</span> <span class="n">save</span> <span class="n">FPA</span><span class="p">,</span> <span class="n">FSA</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r6</span><span class="p">,</span> <span class="n">r6</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x02</span>      <span class="err">@</span> <span class="n">BSC</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r6</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00</span><span class="p">]</span>      <span class="err">@</span> <span class="n">save</span> <span class="n">BSA</span><span class="p">,</span> <span class="n">BSC</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>       <span class="err">@</span> <span class="n">clear</span> <span class="n">interrupt</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x80</span><span class="p">]</span>      <span class="err">@</span> <span class="n">write</span> <span class="n">load</span> <span class="n">command</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r7</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x100</span>       <span class="err">@</span> <span class="n">need</span> <span class="n">small</span> <span class="n">delay</span>
</span><span class='line'>
</span><span class='line'><span class="nl">onenand_wait_loop1</span><span class="p">:</span>
</span><span class='line'>  <span class="n">subs</span> <span class="n">r7</span><span class="p">,</span> <span class="n">r7</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_wait_loop1</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x2</span>       <span class="err">@</span> <span class="n">next</span> <span class="n">FPA</span><span class="p">,</span> <span class="n">FSA</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r6</span><span class="p">,</span> <span class="n">r6</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x2</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r6</span><span class="p">,</span> <span class="n">r6</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x200</span>     <span class="err">@</span> <span class="n">next</span> <span class="n">BSA</span>
</span><span class='line'>  <span class="n">cmp</span>  <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x8</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_bl1_load</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm">  * Go setup Memory and board specific bits prior to relocation.</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">lowlevel_init</span>    <span class="cm">/* go setup pll,mux,memory */</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* when we already run in ram, we don&#39;t need to relocate U-Boot.</span>
</span><span class='line'><span class="cm">  * and actually, memory controller must be configured before U-Boot</span>
</span><span class='line'><span class="cm">  * is running in ram.</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="o">=</span><span class="mh">0xff000fff</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">r0</span>       <span class="cm">/* r0 &lt;- current base addr of code */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">_TEXT_BASE</span>     <span class="cm">/* r1 &lt;- original base addr in ram */</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r0</span>       <span class="cm">/* r0 &lt;- current base addr of code */</span>
</span><span class='line'>  <span class="n">cmp</span>     <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span>                  <span class="cm">/* compare r0, r1                  */</span>
</span><span class='line'>  <span class="n">beq</span>     <span class="n">after_copy</span>        <span class="cm">/* r0 == r1 then skip flash copy   */</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_NOR           </span><span class="cm">/* relocate U-Boot to RAM */</span><span class="cp"></span>
</span><span class='line'>  <span class="n">adr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">_start</span>     <span class="cm">/* r0 &lt;- current position of code   */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span> <span class="cm">/* r1 &lt;- destination                */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">_armboot_start</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r3</span><span class="p">,</span> <span class="n">_bss_start</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r2</span>       <span class="cm">/* r2 &lt;- size of armboot            */</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r2</span>       <span class="cm">/* r2 &lt;- source end address         */</span>
</span><span class='line'>
</span><span class='line'><span class="nl">nor_copy_loop</span><span class="p">:</span>
</span><span class='line'>  <span class="n">ldmia</span>    <span class="n">r0</span><span class="o">!</span><span class="p">,</span> <span class="p">{</span><span class="n">r3</span><span class="o">-</span><span class="n">r10</span><span class="p">}</span>       <span class="cm">/* copy from source address [r0]    */</span>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">r1</span><span class="o">!</span><span class="p">,</span> <span class="p">{</span><span class="n">r3</span><span class="o">-</span><span class="n">r10</span><span class="p">}</span>       <span class="cm">/* copy to   target address [r1]    */</span>
</span><span class='line'>  <span class="n">cmp</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r2</span>         <span class="cm">/* until source end addreee [r2]    */</span>
</span><span class='line'>  <span class="n">ble</span>  <span class="n">nor_copy_loop</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">after_copy</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_NAND</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1000</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">copy_from_nand</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_MOVINAND</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">movi_bl2_copy</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">after_copy</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_ONENAND</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x50000000</span>        <span class="err">@</span> <span class="n">temporary</span> <span class="n">stack</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_S3C6400</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x20000000</span>        <span class="err">@</span> <span class="n">start</span> <span class="n">buffer</span> <span class="k">register</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc30000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc800</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x23000000</span>      <span class="err">@</span> <span class="n">start</span> <span class="n">buffer</span> <span class="k">register</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x30000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc800</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x84</span><span class="p">]</span>      <span class="err">@</span> <span class="n">ecc</span> <span class="n">bypass</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x100</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x84</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0400</span>        <span class="err">@</span> <span class="n">start</span> <span class="n">address1</span> <span class="k">register</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00</span><span class="p">]</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x04</span><span class="p">]</span>      <span class="err">@</span> <span class="n">select</span> <span class="n">dataram</span> <span class="k">for</span> <span class="n">DDP</span> <span class="n">as</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r4</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x104</span>       <span class="err">@</span> <span class="n">interrupt</span> <span class="k">register</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r6</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0c00</span>      <span class="err">@</span> <span class="n">fixed</span> <span class="n">dataram1</span> <span class="n">sector</span> <span class="n">number</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r6</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r3</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>     <span class="err">@</span> <span class="n">DFS</span><span class="p">,</span> <span class="n">FBA</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0000</span>      <span class="err">@</span> <span class="n">FPA</span><span class="p">,</span> <span class="n">FSA</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r9</span><span class="p">,</span> <span class="o">=</span><span class="n">CFG_PHY_UBOOT_BASE</span> <span class="err">@</span> <span class="n">destination</span>
</span><span class='line'>
</span><span class='line'><span class="nl">onenand_bl2_load</span><span class="p">:</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00</span><span class="p">]</span>      <span class="err">@</span> <span class="n">save</span> <span class="n">DFS</span><span class="p">,</span> <span class="n">FBA</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r5</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1c</span><span class="p">]</span>      <span class="err">@</span> <span class="n">save</span> <span class="n">FPA</span><span class="p">,</span> <span class="n">FSA</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r7</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>     <span class="err">@</span> <span class="n">clear</span> <span class="n">interrupt</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r7</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r7</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x80</span><span class="p">]</span>      <span class="err">@</span> <span class="n">write</span> <span class="n">load</span> <span class="n">command</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1000</span>
</span><span class='line'><span class="nl">onenand_wait_loop2</span><span class="p">:</span>
</span><span class='line'>  <span class="n">subs</span> <span class="n">r8</span><span class="p">,</span> <span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_wait_loop2</span>
</span><span class='line'>
</span><span class='line'><span class="nl">onenand_wait_int</span><span class="p">:</span>          <span class="err">@</span> <span class="n">wait</span> <span class="n">INT</span> <span class="n">and</span> <span class="n">RI</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r7</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x8000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r8</span><span class="p">,</span> <span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x80</span>
</span><span class='line'>  <span class="n">tst</span>  <span class="n">r7</span><span class="p">,</span> <span class="n">r8</span>
</span><span class='line'>  <span class="n">beq</span>  <span class="n">onenand_wait_int</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r7</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>     <span class="err">@</span> <span class="n">clear</span> <span class="n">interrupt</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r7</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc00</span>       <span class="err">@</span> <span class="n">source</span> <span class="n">address</span> <span class="p">(</span><span class="n">dataram1</span><span class="p">)</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r10</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x40</span>       <span class="err">@</span> <span class="n">copy</span> <span class="n">loop</span> <span class="n">count</span> <span class="p">(</span><span class="mi">64</span> <span class="o">=</span> <span class="mi">2048</span> <span class="o">/</span> <span class="mi">32</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">sp</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span><span class="o">-</span><span class="n">r7</span><span class="p">}</span>        <span class="err">@</span> <span class="n">backup</span>
</span><span class='line'>
</span><span class='line'><span class="nl">onenand_copy_to_ram</span><span class="p">:</span>
</span><span class='line'>  <span class="n">ldmia</span>    <span class="n">r8</span><span class="o">!</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span><span class="o">-</span><span class="n">r7</span><span class="p">}</span>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">r9</span><span class="o">!</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span><span class="o">-</span><span class="n">r7</span><span class="p">}</span>
</span><span class='line'>  <span class="n">subs</span> <span class="n">r10</span><span class="p">,</span> <span class="n">r10</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_copy_to_ram</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldmia</span>    <span class="n">sp</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span><span class="o">-</span><span class="n">r7</span><span class="p">}</span>        <span class="err">@</span> <span class="n">restore</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x4</span>       <span class="err">@</span> <span class="n">next</span> <span class="n">FPA</span>
</span><span class='line'>  <span class="n">cmp</span>  <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x100</span>       <span class="err">@</span> <span class="n">last</span> <span class="n">FPA</span><span class="o">?</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_bl2_load</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* next block */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r5</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>     <span class="err">@</span> <span class="n">reset</span> <span class="n">FPA</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r3</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1</span>       <span class="err">@</span> <span class="n">next</span> <span class="n">FBA</span>
</span><span class='line'>  <span class="n">cmp</span>  <span class="n">r3</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x2</span>     <span class="err">@</span> <span class="n">last</span> <span class="n">FBA</span><span class="o">?</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">onenand_bl2_load</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">after_copy</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_BOOT_ONENAND_IROM</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">onenand_bl2_copy</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">after_copy</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="nl">after_copy</span><span class="p">:</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="o">=</span><span class="n">ELFIN_GPIO_BASE</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="o">=</span><span class="mh">0xC00</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPPDAT_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFPUD_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc0000000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x80000000</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFPUD_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFDAT_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x8000</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFDAT_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFCON_OFFSET</span><span class="p">]</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0xc0000000</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x40000000</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r1</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">GPFCON_OFFSET</span><span class="p">]</span>
</span><span class='line'>  
</span><span class='line'>  
</span><span class='line'><span class="cp">#ifdef CONFIG_ENABLE_MMU</span>
</span><span class='line'><span class="nl">enable_mmu</span><span class="p">:</span>
</span><span class='line'>  <span class="cm">/* enable domain access */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r5</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x0000ffff</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>        <span class="err">@</span> <span class="n">load</span> <span class="n">domain</span> <span class="n">access</span> <span class="k">register</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Set the TTB register */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">_mmu_table_base</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="o">=</span><span class="n">CFG_PHY_UBOOT_BASE</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="o">=</span><span class="mh">0xfff00000</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r2</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Enable the MMU */</span>
</span><span class='line'><span class="nl">mmu_on</span><span class="p">:</span>
</span><span class='line'>  <span class="n">mrc</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">1</span>         <span class="cm">/* Set CR_M to enable MMU */</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>  <span class="n">nop</span>
</span><span class='line'>  <span class="n">nop</span>
</span><span class='line'>  <span class="n">nop</span>
</span><span class='line'>  <span class="n">nop</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="nl">skip_hw_init</span><span class="p">:</span>
</span><span class='line'>  <span class="cm">/* Set up the stack                            */</span>
</span><span class='line'><span class="nl">stack_setup</span><span class="p">:</span>
</span><span class='line'><span class="cp">#ifdef CONFIG_MEMORY_UPPER_CODE</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="o">=</span><span class="p">(</span><span class="n">CFG_UBOOT_BASE</span> <span class="o">+</span> <span class="n">CFG_UBOOT_SIZE</span> <span class="o">-</span> <span class="mh">0xc</span><span class="p">)</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">_TEXT_BASE</span>     <span class="cm">/* upper 128 KiB: relocated uboot   */</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">CFG_MALLOC_LEN</span> <span class="cm">/* malloc area                      */</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="n">CFG_GBL_DATA_SIZE</span> <span class="cm">/* bdinfo                        */</span>
</span><span class='line'><span class="cp">#ifdef CONFIG_USE_IRQ</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CONFIG_STACKSIZE_IRQ</span><span class="o">+</span><span class="n">CONFIG_STACKSIZE_FIQ</span><span class="p">)</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">12</span>        <span class="cm">/* leave 3 words for abort-stack    */</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="nl">clear_bss</span><span class="p">:</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">_bss_start</span>     <span class="cm">/* find start of bss segment        */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">_bss_end</span>       <span class="cm">/* stop here                        */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r2</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00000000</span>      <span class="cm">/* clear                            */</span>
</span><span class='line'>
</span><span class='line'><span class="nl">clbss_l</span><span class="p">:</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r2</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">]</span>     <span class="cm">/* clear loop...                    */</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>
</span><span class='line'>  <span class="n">cmp</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span>
</span><span class='line'>  <span class="n">ble</span>  <span class="n">clbss_l</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">_start_armboot</span>
</span><span class='line'>
</span><span class='line'><span class="nl">_start_armboot</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">start_armboot</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_ENABLE_MMU</span>
</span><span class='line'><span class="nl">_mmu_table_base</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">mmu_table</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * copy U-Boot to SDRAM and jump to ram (from NAND or OneNAND)</span>
</span><span class='line'><span class="cm"> * r0: size to be compared</span>
</span><span class='line'><span class="cm"> * Load 1&#39;st 2blocks to RAM because U-boot&#39;s size is larger than 1block(128k) size</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>  <span class="p">.</span><span class="n">globl</span> <span class="n">copy_from_nand</span>
</span><span class='line'><span class="nl">copy_from_nand</span><span class="p">:</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r10</span><span class="p">,</span> <span class="n">lr</span>        <span class="cm">/* save return address */</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r9</span><span class="p">,</span> <span class="n">r0</span>
</span><span class='line'>  <span class="cm">/* get ready to call C functions */</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span> <span class="cm">/* setup temp stack pointer */</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="mi">12</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">fp</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>           <span class="cm">/* no previous frame, so fp=0 */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r9</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x1000</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">copy_uboot_to_ram</span>
</span><span class='line'>
</span><span class='line'><span class="mi">3</span><span class="o">:</span> <span class="n">tst</span>  <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x0</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">copy_failed</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="o">=</span><span class="mh">0x0c000000</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span>
</span><span class='line'><span class="mi">1</span><span class="o">:</span> <span class="n">ldr</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r4</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">],</span> <span class="err">#</span><span class="mi">4</span>
</span><span class='line'>  <span class="n">teq</span>  <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="n">compare_failed</span>   <span class="cm">/* not matched */</span>
</span><span class='line'>  <span class="n">subs</span> <span class="n">r9</span><span class="p">,</span> <span class="n">r9</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>
</span><span class='line'>  <span class="n">bne</span>  <span class="mi">1</span><span class="n">b</span>
</span><span class='line'>
</span><span class='line'><span class="mi">4</span><span class="o">:</span> <span class="n">mov</span>  <span class="n">lr</span><span class="p">,</span> <span class="n">r10</span>        <span class="cm">/* all is OK */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">lr</span>
</span><span class='line'>
</span><span class='line'><span class="nl">copy_failed</span><span class="p">:</span>
</span><span class='line'>  <span class="n">nop</span>          <span class="cm">/* copy from nand failed */</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">copy_failed</span>
</span><span class='line'>
</span><span class='line'><span class="nl">compare_failed</span><span class="p">:</span>
</span><span class='line'>  <span class="n">nop</span>          <span class="cm">/* compare failed */</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">compare_failed</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * we assume that cache operation is done before. (eg. cleanup_before_linux())</span>
</span><span class='line'><span class="cm"> * actually, we don&#39;t need to do anything about cache if not use d-cache in U-Boot</span>
</span><span class='line'><span class="cm"> * So, in this function we clean only MMU. by scsuh</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * void  theLastJump(void *kernel, int arch_num, uint boot_params);</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="cp">#ifdef CONFIG_ENABLE_MMU</span>
</span><span class='line'>  <span class="p">.</span><span class="n">globl</span> <span class="n">theLastJump</span>
</span><span class='line'><span class="nl">theLastJump</span><span class="p">:</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r9</span><span class="p">,</span> <span class="n">r0</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r3</span><span class="p">,</span> <span class="o">=</span><span class="mh">0xfff00000</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r4</span><span class="p">,</span> <span class="n">_TEXT_PHY_BASE</span>
</span><span class='line'>  <span class="n">adr</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">phy_last_jump</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="n">r3</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="n">r4</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">r5</span>
</span><span class='line'><span class="nl">phy_last_jump</span><span class="p">:</span>
</span><span class='line'>  <span class="cm">/*</span>
</span><span class='line'><span class="cm">  * disable MMU stuff</span>
</span><span class='line'><span class="cm">  */</span>
</span><span class='line'>  <span class="n">mrc</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00002300</span>    <span class="cm">/* clear bits 13, 9:8 (--V- --RS) */</span>
</span><span class='line'>  <span class="n">bic</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00000087</span>    <span class="cm">/* clear bits 7, 2:0 (B--- -CAM) */</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00000002</span>    <span class="cm">/* set bit 2 (A) Align */</span>
</span><span class='line'>  <span class="n">orr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x00001000</span>    <span class="cm">/* set bit 12 (I) I-Cache */</span>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">c8</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="mi">0</span>    <span class="cm">/* flush v4 TLB */</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">r9</span>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Interrupt handling</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> *************************************************************************</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="err">@</span>
</span><span class='line'><span class="err">@</span> <span class="n">IRQ</span> <span class="n">stack</span> <span class="n">frame</span><span class="p">.</span>
</span><span class='line'><span class="err">@</span>
</span><span class='line'><span class="cp">#define S_FRAME_SIZE 72</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#define S_OLD_R0 68</span>
</span><span class='line'><span class="cp">#define S_PSR        64</span>
</span><span class='line'><span class="cp">#define S_PC     60</span>
</span><span class='line'><span class="cp">#define S_LR     56</span>
</span><span class='line'><span class="cp">#define S_SP     52</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#define S_IP     48</span>
</span><span class='line'><span class="cp">#define S_FP     44</span>
</span><span class='line'><span class="cp">#define S_R10        40</span>
</span><span class='line'><span class="cp">#define S_R9     36</span>
</span><span class='line'><span class="cp">#define S_R8     32</span>
</span><span class='line'><span class="cp">#define S_R7     28</span>
</span><span class='line'><span class="cp">#define S_R6     24</span>
</span><span class='line'><span class="cp">#define S_R5     20</span>
</span><span class='line'><span class="cp">#define S_R4     16</span>
</span><span class='line'><span class="cp">#define S_R3     12</span>
</span><span class='line'><span class="cp">#define S_R2     8</span>
</span><span class='line'><span class="cp">#define S_R1     4</span>
</span><span class='line'><span class="cp">#define S_R0     0</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#define MODE_SVC 0x13</span>
</span><span class='line'><span class="cp">#define I_BIT     0x80</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * use bad_save_user_regs for abort/prefetch/undef/swi ...</span>
</span><span class='line'><span class="cm"> * use irq_save_user_regs / irq_restore_user_regs for IRQ/FIQ handling</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span>    <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_FRAME_SIZE</span>       <span class="err">@</span> <span class="n">carve</span> <span class="n">out</span> <span class="n">a</span> <span class="n">frame</span> <span class="n">on</span> <span class="n">current</span> <span class="n">user</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">sp</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span> <span class="o">-</span> <span class="n">r12</span><span class="p">}</span>         <span class="err">@</span> <span class="n">Save</span> <span class="n">user</span> <span class="n">registers</span> <span class="p">(</span><span class="n">now</span> <span class="n">in</span> <span class="n">svc</span> <span class="n">mode</span><span class="p">)</span> <span class="n">r0</span><span class="o">-</span><span class="n">r12</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">_armboot_start</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_MALLOC_LEN</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_GBL_DATA_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="err">@</span> <span class="n">set</span> <span class="n">base</span> <span class="mi">2</span> <span class="n">words</span> <span class="n">into</span> <span class="n">abort</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">ldmia</span>    <span class="n">r2</span><span class="p">,</span> <span class="p">{</span><span class="n">r2</span> <span class="o">-</span> <span class="n">r3</span><span class="p">}</span>          <span class="err">@</span> <span class="n">get</span> <span class="n">values</span> <span class="k">for</span> <span class="s">&quot;aborted&quot;</span> <span class="n">pc</span> <span class="n">and</span> <span class="n">cpsr</span> <span class="p">(</span><span class="n">into</span> <span class="n">parm</span> <span class="n">regs</span><span class="p">)</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_FRAME_SIZE</span>       <span class="err">@</span> <span class="n">grab</span> <span class="n">pointer</span> <span class="n">to</span> <span class="n">old</span> <span class="n">stack</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r5</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_SP</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">lr</span>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">r5</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span> <span class="o">-</span> <span class="n">r3</span><span class="p">}</span>          <span class="err">@</span> <span class="n">save</span> <span class="n">sp_SVC</span><span class="p">,</span> <span class="n">lr_SVC</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">cpsr</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">sp</span>             <span class="err">@</span> <span class="n">save</span> <span class="n">current</span> <span class="n">stack</span> <span class="n">into</span> <span class="n">r0</span> <span class="p">(</span><span class="n">param</span> <span class="k">register</span><span class="p">)</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span>    <span class="n">irq_save_user_regs</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_FRAME_SIZE</span>
</span><span class='line'>  <span class="n">stmia</span>    <span class="n">sp</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span> <span class="o">-</span> <span class="n">r12</span><span class="p">}</span>         <span class="err">@</span> <span class="n">Calling</span> <span class="n">r0</span><span class="o">-</span><span class="n">r12</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r8</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_PC</span>           <span class="err">@</span> <span class="o">!!!!</span> <span class="n">R8</span> <span class="n">NEEDS</span> <span class="n">to</span> <span class="n">be</span> <span class="n">saved</span> <span class="o">!!!!</span> <span class="n">a</span> <span class="n">reserved</span> <span class="n">stack</span> <span class="n">spot</span> <span class="n">would</span> <span class="n">be</span> <span class="n">good</span><span class="p">.</span>
</span><span class='line'>  <span class="n">stmdb</span>    <span class="n">r8</span><span class="p">,</span> <span class="p">{</span><span class="n">sp</span><span class="p">,</span> <span class="n">lr</span><span class="p">}</span><span class="o">^</span>           <span class="err">@</span> <span class="n">Calling</span> <span class="n">SP</span><span class="p">,</span> <span class="n">LR</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mi">0</span><span class="p">]</span>         <span class="err">@</span> <span class="n">Save</span> <span class="n">calling</span> <span class="n">PC</span>
</span><span class='line'>  <span class="n">mrs</span>  <span class="n">r6</span><span class="p">,</span> <span class="n">spsr</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r6</span><span class="p">,</span> <span class="p">[</span><span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span><span class="p">]</span>         <span class="err">@</span> <span class="n">Save</span> <span class="n">CPSR</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r0</span><span class="p">,</span> <span class="p">[</span><span class="n">r8</span><span class="p">,</span> <span class="err">#</span><span class="mi">8</span><span class="p">]</span>         <span class="err">@</span> <span class="n">Save</span> <span class="n">OLD_R0</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">sp</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span>    <span class="n">irq_restore_user_regs</span>
</span><span class='line'>  <span class="n">ldmia</span>    <span class="n">sp</span><span class="p">,</span> <span class="p">{</span><span class="n">r0</span> <span class="o">-</span> <span class="n">lr</span><span class="p">}</span><span class="o">^</span>          <span class="err">@</span> <span class="n">Calling</span> <span class="n">r0</span> <span class="o">-</span> <span class="n">lr</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_PC</span><span class="p">]</span>           <span class="err">@</span> <span class="n">Get</span> <span class="n">PC</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="err">#</span><span class="n">S_FRAME_SIZE</span>
</span><span class='line'>  <span class="n">subs</span> <span class="n">pc</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>         <span class="err">@</span> <span class="k">return</span> <span class="o">&amp;</span> <span class="n">move</span> <span class="n">spsr_svc</span> <span class="n">into</span> <span class="n">cpsr</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span> <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r13</span><span class="p">,</span> <span class="n">_armboot_start</span>        <span class="err">@</span> <span class="n">setup</span> <span class="n">our</span> <span class="n">mode</span> <span class="n">stack</span> <span class="p">(</span><span class="n">enter</span> <span class="n">in</span> <span class="n">banked</span> <span class="n">mode</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r13</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_MALLOC_LEN</span><span class="p">)</span>   <span class="err">@</span> <span class="n">move</span> <span class="n">past</span> <span class="n">malloc</span> <span class="n">pool</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r13</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_GBL_DATA_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="err">@</span> <span class="n">move</span> <span class="n">to</span> <span class="n">reserved</span> <span class="n">a</span> <span class="n">couple</span> <span class="n">spots</span> <span class="k">for</span> <span class="n">abort</span> <span class="n">stack</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">str</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">r13</span><span class="p">]</span>            <span class="err">@</span> <span class="n">save</span> <span class="n">caller</span> <span class="n">lr</span> <span class="n">in</span> <span class="n">position</span> <span class="mi">0</span> <span class="n">of</span> <span class="n">saved</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">mrs</span>  <span class="n">lr</span><span class="p">,</span> <span class="n">spsr</span>           <span class="err">@</span> <span class="n">get</span> <span class="n">the</span> <span class="n">spsr</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span><span class="p">]</span>            <span class="err">@</span> <span class="n">save</span> <span class="n">spsr</span> <span class="n">in</span> <span class="n">position</span> <span class="mi">1</span> <span class="n">of</span> <span class="n">saved</span> <span class="n">stack</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="n">MODE_SVC</span>            <span class="err">@</span> <span class="n">prepare</span> <span class="n">SVC</span><span class="o">-</span><span class="n">Mode</span>
</span><span class='line'>  <span class="err">@</span> <span class="n">msr</span>   <span class="n">spsr_c</span><span class="p">,</span> <span class="n">r13</span>
</span><span class='line'>  <span class="n">msr</span>  <span class="n">spsr</span><span class="p">,</span> <span class="n">r13</span>          <span class="err">@</span> <span class="k">switch</span> <span class="n">modes</span><span class="p">,</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">moves</span> <span class="n">will</span> <span class="n">execute</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">lr</span><span class="p">,</span> <span class="n">pc</span>             <span class="err">@</span> <span class="n">capture</span> <span class="k">return</span> <span class="n">pc</span>
</span><span class='line'>  <span class="n">movs</span> <span class="n">pc</span><span class="p">,</span> <span class="n">lr</span>             <span class="err">@</span> <span class="n">jump</span> <span class="n">to</span> <span class="n">next</span> <span class="n">instruction</span> <span class="o">&amp;</span> <span class="k">switch</span> <span class="n">modes</span><span class="p">.</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span> <span class="n">get_bad_stack_swi</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r13</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>           <span class="err">@</span> <span class="n">space</span> <span class="n">on</span> <span class="n">current</span> <span class="n">stack</span> <span class="k">for</span> <span class="n">scratch</span> <span class="n">reg</span><span class="p">.</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r0</span><span class="p">,</span> <span class="p">[</span><span class="n">r13</span><span class="p">]</span>            <span class="err">@</span> <span class="n">save</span> <span class="n">R0</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">value</span><span class="p">.</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">_armboot_start</span>     <span class="err">@</span> <span class="n">get</span> <span class="n">data</span> <span class="n">regions</span> <span class="n">start</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_MALLOC_LEN</span><span class="p">)</span> <span class="err">@</span> <span class="n">move</span> <span class="n">past</span> <span class="n">malloc</span> <span class="n">pool</span>
</span><span class='line'>  <span class="n">sub</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="p">(</span><span class="n">CFG_GBL_DATA_SIZE</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="err">@</span> <span class="n">move</span> <span class="n">past</span> <span class="n">gbl</span> <span class="n">and</span> <span class="n">a</span> <span class="n">couple</span> <span class="n">spots</span> <span class="k">for</span> <span class="n">abort</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">]</span>         <span class="err">@</span> <span class="n">save</span> <span class="n">caller</span> <span class="n">lr</span> <span class="n">in</span> <span class="n">position</span> <span class="mi">0</span> <span class="n">of</span> <span class="n">saved</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">mrs</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">spsr</span>           <span class="err">@</span> <span class="n">get</span> <span class="n">the</span> <span class="n">spsr</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">lr</span><span class="p">,</span> <span class="p">[</span><span class="n">r0</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span><span class="p">]</span>         <span class="err">@</span> <span class="n">save</span> <span class="n">spsr</span> <span class="n">in</span> <span class="n">position</span> <span class="mi">1</span> <span class="n">of</span> <span class="n">saved</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r0</span><span class="p">,</span> <span class="p">[</span><span class="n">r13</span><span class="p">]</span>            <span class="err">@</span> <span class="n">restore</span> <span class="n">r0</span>
</span><span class='line'>  <span class="n">add</span>  <span class="n">r13</span><span class="p">,</span> <span class="n">r13</span><span class="p">,</span> <span class="err">#</span><span class="mi">4</span>           <span class="err">@</span> <span class="n">pop</span> <span class="n">stack</span> <span class="n">entry</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span> <span class="n">get_irq_stack</span>           <span class="err">@</span> <span class="n">setup</span> <span class="n">IRQ</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">IRQ_STACK_START</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">macro</span> <span class="n">get_fiq_stack</span>           <span class="err">@</span> <span class="n">setup</span> <span class="n">FIQ</span> <span class="n">stack</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">sp</span><span class="p">,</span> <span class="n">FIQ_STACK_START</span>
</span><span class='line'>  <span class="p">.</span><span class="n">endm</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*</span>
</span><span class='line'><span class="cm"> * exception handlers</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">undefined_instruction</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_undefined_instruction</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">software_interrupt</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack_swi</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_software_interrupt</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">prefetch_abort</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_prefetch_abort</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">data_abort</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_data_abort</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">not_used</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_not_used</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifdef CONFIG_USE_IRQ</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">irq</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_irq_stack</span>
</span><span class='line'>  <span class="n">irq_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_irq</span>
</span><span class='line'>  <span class="n">irq_restore_user_regs</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">fiq</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_fiq_stack</span>
</span><span class='line'>  <span class="cm">/* someone ought to write a more effiction fiq_save_user_regs */</span>
</span><span class='line'>  <span class="n">irq_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_fiq</span>
</span><span class='line'>  <span class="n">irq_restore_user_regs</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">irq</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_irq</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="nl">fiq</span><span class="p">:</span>
</span><span class='line'>  <span class="n">get_bad_stack</span>
</span><span class='line'>  <span class="n">bad_save_user_regs</span>
</span><span class='line'>  <span class="n">bl</span>   <span class="n">do_fiq</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif</span>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span> <span class="mi">5</span>
</span><span class='line'><span class="p">.</span><span class="n">global</span> <span class="n">arm1136_cache_flush</span>
</span><span class='line'><span class="nl">arm1136_cache_flush</span><span class="p">:</span>
</span><span class='line'>      <span class="n">mcr</span>  <span class="n">p15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="n">c5</span><span class="p">,</span> <span class="mi">0</span>    <span class="err">@</span> <span class="n">invalidate</span> <span class="n">I</span> <span class="n">cache</span>
</span><span class='line'>      <span class="n">mov</span>  <span class="n">pc</span><span class="p">,</span> <span class="n">lr</span>         <span class="err">@</span> <span class="n">back</span> <span class="n">to</span> <span class="n">caller</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#if defined(CONFIG_INTEGRATOR) &amp;&amp; defined(CONFIG_ARCH_CINTEGRATOR)</span>
</span><span class='line'><span class="cm">/* Use the IntegratorCP function from board/integratorcp/platform.S */</span>
</span><span class='line'><span class="cp">#elif defined(CONFIG_S3C64XX)</span>
</span><span class='line'><span class="cm">/* For future usage of S3C64XX*/</span>
</span><span class='line'><span class="cp">#else</span>
</span><span class='line'>  <span class="p">.</span><span class="n">align</span>    <span class="mi">5</span>
</span><span class='line'><span class="p">.</span><span class="n">globl</span> <span class="n">reset_cpu</span>
</span><span class='line'><span class="nl">reset_cpu</span><span class="p">:</span>
</span><span class='line'>  <span class="n">ldr</span>  <span class="n">r1</span><span class="p">,</span> <span class="n">rstctl</span> <span class="cm">/* get addr for global reset reg */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r3</span><span class="p">,</span> <span class="err">#</span><span class="mh">0x2</span> <span class="cm">/* full reset pll+mpu */</span>
</span><span class='line'>  <span class="n">str</span>  <span class="n">r3</span><span class="p">,</span> <span class="p">[</span><span class="n">r1</span><span class="p">]</span> <span class="cm">/* force reset */</span>
</span><span class='line'>  <span class="n">mov</span>  <span class="n">r0</span><span class="p">,</span> <span class="n">r0</span>
</span><span class='line'><span class="nl">_loop_forever</span><span class="p">:</span>
</span><span class='line'>  <span class="n">b</span>    <span class="n">_loop_forever</span>
</span><span class='line'><span class="nl">rstctl</span><span class="p">:</span>
</span><span class='line'>  <span class="p">.</span><span class="n">word</span> <span class="n">PM_RSTCTRL_WKUP</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-13T23:15:44+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/kdm/'>kdm</a>, <a class='category' href='/blog/categories/linux/'>linux</a>, <a class='category' href='/blog/categories/u-boot/'>u-boot</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/13/u-boot-dot-lds/">
		
			u-boot.lds</a>
	</h2>
	<div class="entry-content">
		<figure class='code'><figcaption><span>u-boot.lds</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='C'><span class='line'><span class="n">OUTPUT_FORMAT</span><span class="p">(</span><span class="s">&quot;elf32-littlearm&quot;</span><span class="p">,</span> <span class="s">&quot;elf32-littlearm&quot;</span><span class="p">,</span> <span class="s">&quot;elf32-littlearm&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">OUTPUT_ARCH</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>
</span><span class='line'><span class="n">ENTRY</span><span class="p">(</span><span class="n">_start</span><span class="p">)</span>
</span><span class='line'><span class="n">SECTIONS</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="mh">0x00000000</span><span class="p">;</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">text</span>      <span class="p">:</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="n">cpu</span><span class="o">/</span><span class="n">s3c64xx</span><span class="o">/</span><span class="n">start</span><span class="p">.</span><span class="n">o</span>  <span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">cpu</span><span class="o">/</span><span class="n">s3c64xx</span><span class="o">/</span><span class="n">s3c6410</span><span class="o">/</span><span class="n">cpu_init</span><span class="p">.</span><span class="n">o</span> <span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">cpu</span><span class="o">/</span><span class="n">s3c64xx</span><span class="o">/</span><span class="n">onenand_cp</span><span class="p">.</span><span class="n">o</span> <span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">cpu</span><span class="o">/</span><span class="n">s3c64xx</span><span class="o">/</span><span class="n">nand_cp</span><span class="p">.</span><span class="n">o</span>    <span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">board</span><span class="o">/</span><span class="n">samsung</span><span class="o">/</span><span class="n">mini6410</span><span class="o">/</span><span class="n">nand_6410</span><span class="p">.</span><span class="n">fo</span>
</span><span class='line'>    <span class="n">cpu</span><span class="o">/</span><span class="n">s3c64xx</span><span class="o">/</span><span class="n">movi</span><span class="p">.</span><span class="n">o</span> <span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="o">*</span><span class="p">(.</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>    <span class="n">lib_arm</span><span class="o">/</span><span class="n">div0</span><span class="p">.</span><span class="n">o</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">rodata</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">rodata</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">data</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">data</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">got</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">got</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">__u_boot_cmd_start</span> <span class="o">=</span> <span class="p">.;</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">u_boot_cmd</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">u_boot_cmd</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">__u_boot_cmd_end</span> <span class="o">=</span> <span class="p">.;</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">mmudata</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">mmudata</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">.</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'>  <span class="n">__bss_start</span> <span class="o">=</span> <span class="p">.;</span>
</span><span class='line'>  <span class="p">.</span><span class="nl">bss</span> <span class="p">:</span> <span class="p">{</span> <span class="o">*</span><span class="p">(.</span><span class="n">bss</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">_end</span> <span class="o">=</span> <span class="p">.;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-13T23:06:13+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/kdm/'>kdm</a>, <a class='category' href='/blog/categories/linux/'>linux</a>, <a class='category' href='/blog/categories/u-boot/'>u-boot</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/08/kdm-devenv/">
		
			KDM-DevEnv</a>
	</h2>
	<div class="entry-content">
		<h2></h2>

<ol>
<li>ext4LinuxPCjffs2yaffs2</li>
<li>LinuxSCSIsd*xaxb1122</li>
<li>swapLinuxWindowspagefile.sys</li>
<li>ARM coreCPU0

<h2></h2>

<blockquote><ol>
<li>VirtualBox4.3.12UbuntuMate14.04</li>
<li>Tiny6410</li>
<li>()</li>
<li>ip192.168.1.88192.168.1.1</li>
</ol>
</blockquote></li>
</ol>


<h2></h2>

<ol>
<li>UbootIP:192.168.1.230,192.168.1.1</li>
<li>SDUBootSDSDHCLinux</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'>#for SDHC Card,total sectors=15523840
</span><span class='line'>#dd iflag=dsync oflag=dsync if=u-boot-sd.bin of=/dev/sdb bs=512 count=16 seek=15522798
</span><span class='line'>#dd iflag=dsync oflag=dsync if=u-boot-sd.bin of=/dev/sdb bs=512 count=512 seek=15522030
</span><span class='line'>
</span><span class='line'>#for SD Card,total sectors=1961984
</span><span class='line'>dd iflag=dsync oflag=dsync if=u-boot-sd.bin of=/dev/sdb bs=512 count=16 seek=1961966
</span><span class='line'>dd iflag=dsync oflag=dsync if=u-boot-sd.bin of=/dev/sdb bs=512 count=512 seek=1961198
</span><span class='line'>sync
</span><span class='line'>#BL1:total sectors - 2 - 1024(if your SD Card Size &gt; 2G) -16
</span><span class='line'>#BL2:total sectors - 2 - 1024(if your SD Card Size &gt; 2G) -16 - 512 - 256</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Ubootpingping 192.168.1.88IPUBootpri</li>
<li>nfsuboot(UBootNandFlashSDUBoot),filesize()

<ul>
<li>nfs 50000000 192.168.1.88:/embeded/KDM/images/v1/u-boot.bin</li>
</ul>
</li>
<li>ubootNandFlash

<ul>
<li>nand write.i 50000000 0 $(filesize)   0UBoot</li>
</ul>
</li>
<li>nfskernelfilesize(())

<ul>
<li>nfs 50000000 192.168.1.88:/embeded/KDM/images/v1/Image</li>
</ul>
</li>
<li>kernelNandFlash

<ul>
<li>nand write.i 50000000 80000 $(filesize)</li>
</ul>
</li>
<li>nfsfilesize(())

<ul>
<li>nfs 50000000 192.168.1.88:/embeded/KDM/images/v1/yaff2.img</li>
</ul>
</li>
<li>NandFlash

<ul>
<li>nand write.yaffs 50000000 580000 $(filesize)</li>
</ul>
</li>
<li>,

<ul>
<li>setenv bootargs root=/dev/mtdblock2 console=ttySAC0,115200</li>
<li>saveenv</li>
</ul>
</li>
</ol>


<h2></h2>

<ul>
<li>tslibts_calibrate,Linux/usr/local/bin/ts_calibrate(/etc/pointercalts_calibrate)etcpointercal</li>
</ul>


<h2></h2>

<ul>
<li>arm-linux-gcc4ELF4arm-linux-cpparm-linux-ascclarm-linux-ld-E,-S-c4</li>
<li>ELFnot stripped</li>
<li>glibcopen,read,write,select,ioctllibc.soglibclibm.so()libcrypt.so()libld.so()libld.so</li>
<li>arm-linux-strip test</li>
<li>arm-linux-objcopy -O binary -S test test.bin ELFtest.bin.</li>
<li>arm-linux-dump -D test > test.disELFtest.dis</li>
<li>arm-linux-readelf -a test | grep &lsquo;Shared'ELFgrep 'Shared'test</li>
<li>arm-linux-gcc arm11

<ol>
<li>&ndash;with-cpu=arm1176jzf-s</li>
<li>&ndash;with-tune=arm1176jzf-s</li>
<li>&ndash;with-float=softfp</li>
</ol>
</li>
</ul>


<h2>bootloader</h2>

<ul>
<li>Bootloaderxmodem/ymodem/zmodemtftpnfs</li>
<li>bootloaderstage1

<ol>
<li>

<ul>
<li></li>
<li>CPU</li>
<li>RAM</li>
<li>CPU/cache</li>
</ul>
</li>
<li>Bootloaderstage2RAM</li>
<li>bootloaderstage2RAM</li>
<li>sp</li>
<li>stage2CPC</li>
</ol>
</li>
<li>bootloaderstage2

<ol>
<li>

<ul>
<li>I/O</li>
</ul>
</li>
<li></li>
<li>kernelFlashRAM(Nand Flash)</li>
<li>

<ul>
<li>linux2.4ATAG_COREATAG_NONE</li>
<li>tag_headertagtag_headerLinuxinclude/asm/setup.h</li>
<li>LinuxBootloaderATAG_CORE,ATAG_MEN,ATAG_CMDLINE</li>
</ul>
</li>
<li>

<ol>
<li>CPU

<ul>
<li>R0=0</li>
<li>R1=IDMachine Type Numberlinux/arch/arm/tools/mach-types</li>
<li>R2=RAM</li>
</ul>
</li>
<li>CPU

<ul>
<li> (IRQsFIQs)</li>
<li>CPUSVC</li>
</ul>
</li>
<li>CacheMMU

<ul>
<li>MMU</li>
<li>Cache</li>
<li>Cache</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li>U-boot

<ol>
<li></li>
<li></li>
<li>U-Boot</li>
</ol>
</li>
</ul>


<h2>Qt</h2>

<ul>
<li>QtLinuxframbuffer</li>
<li>Qt

<ol>
<li></li>
</ol>
</li>
</ul>


<h2>tslib</h2>

<ol>
<li><a href="http://download.csdn.net/detail/liuqiqi677/3177449"></a></li>
<li>tslib</li>
<li><code>./autogen.sh</code>configure</li>
<li><code>./configure --host=arm-linux --disable-h3600 --disable-arctic2 --disable-mk712 --disable-collie --disable-corgi --disable-ucb1x00 --with-gnu-ld --prefix=/embeded/tslib_install ac_cv_func_malloc_0_nonnull=yes</code> &ndash;host&ndash;disable Linuxinput&ndash;with-gnu-ldGNULDGNU&ndash;prefixac_cv_func_malloc_0_nonnull./configureGNUmalloc</li>
<li>/embeded/tslib_install,etcts.conf.pthresvariancedejitterlinear

<ul>
<li>module_raw input</li>
<li>module pthres pmin=1</li>
<li>module variance delta=30</li>
<li>module dejitter delta=100</li>
<li>module linear</li>
</ul>
</li>
</ol>


<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-08T22:30:05+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/develop/'>develop</a>, <a class='category' href='/blog/categories/kdm/'>kdm</a>, <a class='category' href='/blog/categories/linux/'>linux</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/06/08/gns3-install/">
		
			GNS3_Install</a>
	</h2>
	<div class="entry-content">
		<h2>GNS3</h2>

<ol>
<li><a href="https://community.gns3.com/community/software/download/">GNS3</a></li>
<li><a href="https://community.gns3.com/community/software/download/">GNS3 IOU VM</a></li>
<li>IOS()

<ul>
<li>i86bi-linux-l2-ipbasek9-15.1g.bin()</li>
<li>i86bi-linux-l3-adventerprisek9-15.4.1T.bin()</li>
</ul>
</li>
<li>virtualbox</li>
<li>2GNS3hostonly</li>
<li>GNS3linuxrootciscoipifconfig</li>
<li>IP8000upload<a href="http://192.168.172.101:8000/upload">http://192.168.172.101:8000/upload</a></li>
<li>GNS3edit->Preference->ServerIP(ip6)</li>
<li>edit->Preference->IOS on UNIXiourc.txt</li>
<li>edit->Preference->IOU devicesswitchrouter(/home/gns3/GNS3/images/IOU/i86bi-linux-l2-ipbasek9-15.1g.bin)</li>
<li></li>
</ol>


<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-06-08T11:24:09+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/gns3/'>gns3</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/28/python-baseknowledge/">
		
			Python-BaseKnowledge</a>
	</h2>
	<div class="entry-content">
		<h2>Python</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='Python'><span class='line'><span class="k">class</span> <span class="nc">_const</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">ConstError</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span> <span class="k">pass</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
</span><span class='line'>      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span><span class='line'>          <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstError</span><span class="p">,</span><span class="s">&quot;Can&#39;t rebind const(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">name</span>
</span><span class='line'>      <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
</span><span class='line'>          <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstError</span><span class="p">,</span><span class="s">&quot;Can&#39;t unbind const(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">name</span>
</span><span class='line'>      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">,</span> <span class="n">name</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">_const</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>const.pyPythonLib</li>
</ul>


<h2></h2>

<ol>
<li></li>
<li></li>
<li>r</li>
<li>

<ul>
<li>0</li>
<li>[a:b]ab-10</li>
</ul>
</li>
<li>

<ul>
<li>students=[&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;]0</li>
</ul>
</li>
<li>

<ul>
<li>students=(&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;,&ldquo;&rdquo;)</li>
</ul>
</li>
<li>Pythonset()

<ul>
<li>&amp;</li>
<li>|</li>
<li>-</li>
<li>new=set(a)</li>
</ul>
</li>
<li>

<ul>
<li>k={&ldquo;name&rdquo;:&ldquo;Java&rdquo;,&ldquo;IDE&rdquo;:&ldquo;Eclipse&rdquo;}</li>
<li>print k[&ldquo;IDE&rdquo;]</li>
<li>k[&ldquo;User&rdquo;]=&ldquo;morris&rdquo;</li>
</ul>
</li>
<li>Python</li>
<li>Pythonpickle

<ul>
<li>import pickle</li>
<li>lista=[&ldquo;mingyue&rdquo;,&ldquo;jishi&rdquo;,&ldquo;you&rdquo;]</li>
<li>listb=pickle.dumps(lista)#</li>
<li>listc=pickle.loads(listb)#</li>
<li>group1=(&ldquo;bajiu&rdquo;,&ldquo;wen&rdquo;,&ldquo;qingtian&rdquo;)</li>
<li>f1=file(&lsquo;1.pkl&rsquo;,&lsquo;wb&rsquo;)</li>
<li>pickle.dump(group1,f1,True)</li>
<li>f1.close()</li>
<li>f2=file(&lsquo;1.pkl&rsquo;,&lsquo;rb&rsquo;)</li>
<li>t=pickle.load(f2)</li>
<li>f2.close()</li>
</ul>
</li>
<li>Python\</li>
<li></li>
</ol>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-28T21:42:24+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/python/'>python</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/28/cordova-startup/">
		
			Cordova-Startup</a>
	</h2>
	<div class="entry-content">
		<h2>Cordova</h2>

<ul>
<li><a href="https://nodejs.org">nodejs</a>,PATH</li>
<li>Cordova CLI npm install -g cordova</li>
<li><a href="http://java.oracle.com">Java JDK</a>,CLASSPATHPATH</li>
<li><a href="http://developer.android.com/sdk/index.html">Android SDK</a>platform-toolstoolsPATH</li>
<li><a href="http://ant.apache.org/">Ant</a>,binPATH</li>
<li>

<ol>
<li>npm -v</li>
<li>java -version</li>
<li>adb version</li>
<li>ant -v</li>
<li>cordova -v</li>
</ol>
</li>
<li>cordova

<ol>
<li><code>cordova creat   APP</code></li>
<li><code>cordova build</code></li>
<li><code>cordova run --device</code></li>
</ol>
</li>
</ul>


<h2>Cordova</h2>

<ol>
<li></li>
<li>splashscreen</li>
<li>Load HTML</li>
<li>JavaScript$(document).ready()</li>
<li>Cordova.js()</li>
<li>deviceready</li>
<li>Cordova</li>
</ol>


<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-28T10:43:48+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/cordova/'>cordova</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/25/microsoft-office-word-skills/">
		
			Microsoft-Office-Word-Skills</a>
	</h2>
	<div class="entry-content">
		<h2></h2>

<ol>
<li></li>
<li><code></code></li>
<li><code></code></li>
<li><code></code></li>
<li></li>
<li><code></code></li>
<li></li>
<li><code></code></li>
<li><code></code>->1</li>
<li><code></code><code></code>,</li>
</ol>


<h2></h2>

<ol>
<li></li>
<li>()()</li>
<li></li>
<li>TabTab</li>
</ol>


<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-25T10:45:43+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/office/'>office</a>, <a class='category' href='/blog/categories/practise/'>practise</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/24/ubuntu-mate-14-04-2-lts-install/">
		
			Ubuntu-Mate-14-04-2-LTS-Install</a>
	</h2>
	<div class="entry-content">
		<h2>Ubuntu-Mate14.04.2-LTS</h2>

<ol>
<li><a href="https://ubuntu-mate.org/">Ubutnu-MateISO</a></li>
<li>->->()</li>
<li>:<code>sudo apt-get install</code>

<ul>
<li>:gedit vim</li>
<li>build-essential</li>
<li>Makefileautoconf automake</li>
<li>flex bison texinfo git-core gnupg gperf valgrind</li>
<li>Cmanpages-dev libncurses-dev libsdl-dev libesd0-dev libwxgtk2.6-dev ncurses-dev</li>
<li>binutils-doc cpp-doc gcc-doc glib-doc stl-manual</li>
<li> zip</li>
<li>: curl</li>
<li>minicomminicom<code>sudo chown morrismorris /etc/minicom/minirc.dfl</code></li>
<li>Ubuntu-Tweak

<ul>
<li>tweaksudo add-apt-repository ppa:tualatrix/ppa</li>
<li>sudo apt-get update</li>
<li>ubuntu-tweaksudo apt-get install ubuntu-tweak</li>
</ul>
</li>
<li>vimwget -qO- <a href="https://raw.github.com/ma6174/vim/master/setup.sh">https://raw.github.com/ma6174/vim/master/setup.sh</a> | sh -x</li>
<li>ugetaria2

<ul>
<li><code>sudo add-apt-repository ppa:plushuang-tw/uget-stable</code></li>
<li><code>sudo ap-get update</code></li>
<li><code>sudo apt-get install uget</code></li>
<li><code>sudo apt-get install aria2</code></li>
<li>ugetaria</li>
<li>16</li>
</ul>
</li>
<li>fcitx:

<ul>
<li><code>sudo apt-get install fcitx-table-wbpy</code></li>
<li><code></code>-><code></code><code>fcitx</code></li>
</ul>
</li>
<li>WPSUbuntuOffice</li>
<li><a href="http://www.qt.io/download/">Qt</a>QtCreator</li>
<li>Lua5.3

<ul>
<li><a href="http://www.lua.org/ftp"></a></li>
<li><code>sudo apt-get install libreadline</code><code>sudo apt-get install libreadline-gplv2-dev</code></li>
<li>Makefile</li>
<li><code>make linux</code><code>make install</code></li>
</ul>
</li>
<li>crosstool-ng
  <code>sudo apt-get install bison flex texinfo automake libtool cvs patch curl gcj subversion gawk cvsd gperf libexpat1-dev</code></li>
</ul>
</li>
<li>VirtualBox

<ul>
<li>VirtualBox-></li>
<li>UbuntuCD(media)sudo ./VBoxLinuxAdditions.run</li>
</ul>
</li>
<li>root<code>sudo passwd root</code></li>
<li>UbuntuJDK

<ol>
<li>JDKJava

<ul>
<li><code>update-alternatives --install /usr/bin/java java /usr/lib/jvm/java/jdk1.6.0_12/bin/java 300</code></li>
<li><code>update-alternatives --install /usr/bin/javac javac /usr/lib/jvm/java/jdk1.6.0_12/bin/javac 300</code></li>
</ul>
</li>
<li>JDK

<ul>
<li><code>sudo update-alternatives --config java</code></li>
</ul>
</li>
</ol>
</li>
<li>NFS

<ol>
<li>NFS<code>sudo apt-get install nfs-kernel-server portmap</code></li>
<li>

<ul>
<li>/etc/exports:<code>/embeded/WenRisOS/NFS_doc *(rw,sync,no_root_squash)</code></li>
</ul>
</li>
<li>:<code>sudo /etc/init.d/nfs-kernel-server restart</code></li>
<li>NFS<code>showmount -e</code></li>
<li>mount -o nolock -t nfs 192.168.1.88:/embeded/WenRisOS/NFS_doc /mnt</li>
<li>ubootnfs<code>nfs 0x32000000 192.168.1.11:/work/system/linux/arch/arm/boot/uImage</code></li>
</ol>
</li>
<li>FTP

<ol>
<li>FTP<code>sudo apt-get install vsftpd</code></li>
<li>FTP:<code>sudo vim /etc/vsftpd.conf</code>

<ul>
<li>listen,local_enable,write_enable</li>
</ul>
</li>
<li>FTP

<ul>
<li><code>sudo /etc/init.d/vsftpd restart</code></li>
</ul>
</li>
</ol>
</li>
<li>JLink

<ul>
<li><a href="https://www.segger.com/jlink-software.html">J-Link</a></li>
<li>Linux64LinuxTGA5.0</li>
<li>README.txt,5.0<code>sudo cp 99-jlink.rules /etc/udev/rules.d/</code></li>
<li>JLinkUSB<code>./JLinkExe</code>,usbUSBJLinkusbusb</li>
</ul>
</li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>J-Link&gt;usb
</span><span class='line'>Connecting to J-Link via USB (Port: 0)
</span><span class='line'>DLL version V5.00, compiled Jun  8 2015 21:14:03
</span><span class='line'>Firmware: J-Link ARM V8 compiled Nov 28 2014 13:44:46
</span><span class='line'>Hardware: V8.00
</span><span class='line'>S/N: 158000503 
</span><span class='line'>Feature(s): RDI,FlashDL,FlashBP,JFlash,GDBFull 
</span><span class='line'>VTarget = 3.319V
</span><span class='line'>Info: TotalIRLen = 9, IRPrint = 0x0011
</span><span class='line'>Found 2 JTAG devices, Total IRLen = 5:
</span><span class='line'>  #0 Id: 0x2B900F0F, IRLen: 04, IRPrint: 0x0, ARM ETB
</span><span class='line'>  #1 Id: 0x07B76F0F, IRLen: 05, IRPrint: 0x1, ARM1176 Core
</span><span class='line'>ARM11 identified.
</span><span class='line'>Target interface speed: 100 kHz
</span><span class='line'>J-Link&gt;</span></code></pre></td></tr></table></div></figure>


<h2></h2>

<ol>
<li>Ubuntu

<ul>
<li>.Xauthorityroot.Xauthority</li>
<li>1.Xauthorityshift + ctrl + F1tty: sudo chown : .Xauthority</li>
<li>2dpkg-reconfigure lightdm</li>
</ul>
</li>
<li>6432

<ul>
<li>64

<ul>
<li><code>dpkg --print-architecture</code>,amd6464</li>
</ul>
</li>
<li>

<ul>
<li><code>dpkg --print-foreign-architecture</code>,i386</li>
<li>

<ul>
<li><code>sudo dpkg --add-architecture i386</code><code>sudo apt-get update</code></li>
<li><code>sudo apt-get -f dist-upgrade</code></li>
</ul>
</li>
</ul>
</li>
<li>

<ul>
<li><code>sudo apt-get install libc6:i386</code></li>
<li><code>sudo apt-get install gcc-multilib g++-multilib</code></li>
<li><code>sudo apt-get install lib32z1 lib32ncurses5 lib32bz2-1.0 libgtk2.0-0:i386 libpangox-1.0-0:i386 libpangoxft-1.0-0:i386 libidn11:i386 gstreamer0.10-pulseaudio:i386 gstreamer0.10-plugins-base:i386 gstreamer0.10-plugins-good:i386</code></li>
</ul>
</li>
<li>13.10Ubuntuia32-libs</li>
</ul>


<pre><code class="`Shell Ubuntu14.04ia32-libs"> sudo -i
 cd /etc/apt/sources.list.d
 echo "deb http://archive.ubuntu.com/ubuntu/ raring main restricted universe multiverse" &gt;ia32-libs-raring.list
 apt-get update
 apt-get install ia32-libs
 rm /etc/apt/sources.list.d/ia32-libs-raring.list
 apt-get update
 exit
 sudo apt-get install gcc-multilib
</code></pre></li>
</ol>


<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-24T20:02:37+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/software/'>software</a>, <a class='category' href='/blog/categories/ubuntu/'>ubuntu</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/23/nuvoton-m451-eadc/">
		
			Nuvoton-M451-EADC</a>
	</h2>
	<div class="entry-content">
		<h2>CortexM4M451&mdash;-EADC</h2>

<blockquote><ul>
<li>121683SAR-ADC()</li>
<li>PWM0/1timer0~3ADINT0ADINT1EOC()(STADC)</li>
<li>Vref5V1210</li>
<li>3,</li>
<li>4ADC(ADINT0~3)</li>
<li>ADC20MHz</li>
<li>1Msps</li>
<li></li>
<li>0~3</li>
<li>18/</li>
<li>PDMA</li>
<li>4ADCADINT0~3ADINT0/ADINT1EOC(0~18)</li>
<li>ADC4<code>EADC_CMP0~EADC_CMP3</code>0~184A/D</li>
<li>DCCMPWEN<code>EADC_CMP0</code><code>EADC_CMP1</code>ADCMPF0<code>EADC_CMP2</code><code>EADC_CMP3</code>ADCMPF2</li>
<li>=<code>TRGDLYCNT*ADC_CLK*n</code>(n=1,2,4,16TRGDLYDIV).</li>
</ul>
</blockquote>

<h2></h2>

<p><img src="http://i.imgur.com/6HZ5VTs.png" alt="Nuvoton-M451-EADC" /></p>

<h2>API</h2>

<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-23T22:28:12+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/nuvoton-m451/'>nuvoton-m451</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/05/23/nuvoton-m451-pwm/">
		
			Nuvoton-m451-pwm</a>
	</h2>
	<div class="entry-content">
		<p><img src="http://i.imgur.com/Nn7Krru.gif" alt="suda-morris" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-05-23T18:03:13+08:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/nuvoton-m451/'>nuvoton-m451</a>, <a class='category' href='/blog/categories/study/'>study</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/posts/2" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    suda-morris

Powered by Octopress-WenRis Group
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>